using Dapper;
using System;
using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;
using System.Text;
using KKFCoreEngine.Util;

namespace PDK1ADO.Connect.Mssql.Product
{
    public class PDK1_M_PaOunDamAdo   : ProductBase
    {
        private static PDK1_M_PaOunDamAdo instant;

        public static PDK1_M_PaOunDamAdo GetInstant()
        {
            if (instant == null) instant = new PDK1_M_PaOunDamAdo();
            return instant;
        }

        private string conectStr { get; set; }

        private PDK1_M_PaOunDamAdo() { }


        public List<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam> ListActive()
        {
            string cmd = " SELECT * FROM product.dbo.PDK1_M_PaOunDam ";

            var res = Query<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam>(cmd, null).ToList();

            return res;
        }

        public List<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam> GetData(PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam d)
        {
            DynamicParameters param = new DynamicParameters();
            param.Add("@brn_pay", d.brn_pay);
            param.Add("@pay_date", d.pay_date);
            param.Add("@bar_grp", d.bar_grp);
            param.Add("@res_id", d.res_id);
            param.Add("@pay_item", d.pay_item);
            param.Add("@oun_date", d.oun_date);
            param.Add("@item", d.item);
            param.Add("@mach_id", d.mach_id);
            param.Add("@stock", d.stock);
            param.Add("@quantity", d.quantity);
            param.Add("@weight", d.weight);
            param.Add("@staff", d.staff);
            param.Add("@rec_date", d.rec_date);
            param.Add("@rec_qty", d.rec_qty);
            param.Add("@rec_wei", d.rec_wei);
            param.Add("@u_price", d.u_price);
            param.Add("@t_price", d.t_price);
            param.Add("@s_price", d.s_price);
            param.Add("@roy_prc", d.roy_prc);
            param.Add("@flag", d.flag);
            param.Add("@chk", d.chk);
            param.Add("@edit_flag", d.edit_flag);
            param.Add("@post_flag", d.post_flag);
            param.Add("@o_flag", d.o_flag);
            param.Add("@barcode", d.barcode);
            param.Add("@bill", d.bill);
            param.Add("@ppost_flag", d.ppost_flag);
            param.Add("@p_type", d.p_type);
            param.Add("@group", d.group);
            param.Add("@branch", d.branch);
            param.Add("@prn_flag", d.prn_flag);
            param.Add("@backupflag", d.backupflag);
            param.Add("@pqgradecd", d.pqgradecd);
            param.Add("@prb_code", d.prb_code);
            //param.Add("@txtSearch", $"%{d.txtSearch.GetValue()}%");

            string cmd = "SELECT * FROM product.dbo.PDK1_M_PaOunDam " +
            $"WHERE (@brn_pay IS NULL OR brn_pay = @brn_pay) " +
            $"  AND (@pay_date IS NULL OR pay_date = @pay_date) " +
            $"  AND (@bar_grp IS NULL OR bar_grp = @bar_grp) " +
            $"  AND (@res_id IS NULL OR res_id = @res_id) " +
            $"  AND (@pay_item IS NULL OR pay_item = @pay_item) " +
            $"  AND (@oun_date IS NULL OR oun_date = @oun_date) " +
            $"  AND (@item IS NULL OR item = @item) " +
            $"  AND (@mach_id IS NULL OR mach_id = @mach_id) " +
            $"  AND (@stock IS NULL OR stock = @stock) " +
            $"  AND (@quantity IS NULL OR quantity = @quantity) " +
            $"  AND (@weight IS NULL OR weight = @weight) " +
            $"  AND (@staff IS NULL OR staff = @staff) " +
            $"  AND (@rec_date IS NULL OR rec_date = @rec_date) " +
            $"  AND (@rec_qty IS NULL OR rec_qty = @rec_qty) " +
            $"  AND (@rec_wei IS NULL OR rec_wei = @rec_wei) " +
            $"  AND (@u_price IS NULL OR u_price = @u_price) " +
            $"  AND (@t_price IS NULL OR t_price = @t_price) " +
            $"  AND (@s_price IS NULL OR s_price = @s_price) " +
            $"  AND (@roy_prc IS NULL OR roy_prc = @roy_prc) " +
            $"  AND (@flag IS NULL OR flag = @flag) " +
            $"  AND (@chk IS NULL OR chk = @chk) " +
            $"  AND (@edit_flag IS NULL OR edit_flag = @edit_flag) " +
            $"  AND (@post_flag IS NULL OR post_flag = @post_flag) " +
            $"  AND (@o_flag IS NULL OR o_flag = @o_flag) " +
            $"  AND (@barcode IS NULL OR barcode = @barcode) " +
            $"  AND (@bill IS NULL OR bill = @bill) " +
            $"  AND (@ppost_flag IS NULL OR ppost_flag = @ppost_flag) " +
            $"  AND (@p_type IS NULL OR p_type = @p_type) " +
            $"  AND (@group IS NULL OR group = @group) " +
            $"  AND (@branch IS NULL OR branch = @branch) " +
            $"  AND (@prn_flag IS NULL OR prn_flag = @prn_flag) " +
            $"  AND (@backupflag IS NULL OR backupflag = @backupflag) " +
            $"  AND (@pqgradecd IS NULL OR pqgradecd = @pqgradecd) " +
            $"  AND (@prb_code IS NULL OR prb_code = @prb_code) ";
            //$"AND (brn_pay LIKE @txtSearch OR brn_pay LIKE @txtSearch) " +  
            //"ORDER BY  ;"; 
            var res = Query<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam>(cmd, param).ToList();
            return res;
        }

        public List<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam> Search(PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam d)
        {
            DynamicParameters param = new DynamicParameters();
            /*
            param.Add("@brn_payIsNull", d.brn_pay.ListNull()); 
            param.Add("@pay_dateIsNull", d.pay_date.ListNull()); 
            param.Add("@bar_grpIsNull", d.bar_grp.ListNull()); 
            param.Add("@res_idIsNull", d.res_id.ListNull()); 
            param.Add("@pay_itemIsNull", d.pay_item.ListNull()); 
            param.Add("@oun_dateIsNull", d.oun_date.ListNull()); 
            param.Add("@itemIsNull", d.item.ListNull()); 
            param.Add("@mach_idIsNull", d.mach_id.ListNull()); 
            param.Add("@stockIsNull", d.stock.ListNull()); 
            param.Add("@quantityIsNull", d.quantity.ListNull()); 
            param.Add("@weightIsNull", d.weight.ListNull()); 
            param.Add("@staffIsNull", d.staff.ListNull()); 
            param.Add("@rec_dateIsNull", d.rec_date.ListNull()); 
            param.Add("@rec_qtyIsNull", d.rec_qty.ListNull()); 
            param.Add("@rec_weiIsNull", d.rec_wei.ListNull()); 
            param.Add("@u_priceIsNull", d.u_price.ListNull()); 
            param.Add("@t_priceIsNull", d.t_price.ListNull()); 
            param.Add("@s_priceIsNull", d.s_price.ListNull()); 
            param.Add("@roy_prcIsNull", d.roy_prc.ListNull()); 
            param.Add("@flagIsNull", d.flag.ListNull()); 
            param.Add("@chkIsNull", d.chk.ListNull()); 
            param.Add("@edit_flagIsNull", d.edit_flag.ListNull()); 
            param.Add("@post_flagIsNull", d.post_flag.ListNull()); 
            param.Add("@o_flagIsNull", d.o_flag.ListNull()); 
            param.Add("@barcodeIsNull", d.barcode.ListNull()); 
            param.Add("@billIsNull", d.bill.ListNull()); 
            param.Add("@ppost_flagIsNull", d.ppost_flag.ListNull()); 
            param.Add("@p_typeIsNull", d.p_type.ListNull()); 
            param.Add("@groupIsNull", d.group.ListNull()); 
            param.Add("@branchIsNull", d.branch.ListNull()); 
            param.Add("@prn_flagIsNull", d.prn_flag.ListNull()); 
            param.Add("@backupflagIsNull", d.backupflag.ListNull()); 
            param.Add("@pqgradecdIsNull", d.pqgradecd.ListNull()); 
            param.Add("@prb_codeIsNull", d.prb_code.ListNull()); 
            param.Add("@txtSearch", $"%{d.txtSearch.GetValue()}%");
            */

            string cmd = "";
            /*
            string cmd = "SELECT * FROM product.dbo.PDK1_M_PaOunDam " +
            $"WHERE (@brn_payIsNull IS NULL OR brn_pay IN ('{ d.brn_pay.Join("','") }')) " +
            $"AND (@pay_dateIsNull IS NULL OR pay_date IN ('{ d.pay_date.Join("','") }')) " +
            $"AND (@bar_grpIsNull IS NULL OR bar_grp IN ('{ d.bar_grp.Join("','") }')) " +
            $"AND (@res_idIsNull IS NULL OR res_id IN ('{ d.res_id.Join("','") }')) " +
            $"AND (@pay_itemIsNull IS NULL OR pay_item IN ('{ d.pay_item.Join("','") }')) " +
            $"AND (@oun_dateIsNull IS NULL OR oun_date IN ('{ d.oun_date.Join("','") }')) " +
            $"AND (@itemIsNull IS NULL OR item IN ('{ d.item.Join("','") }')) " +
            $"AND (@mach_idIsNull IS NULL OR mach_id IN ('{ d.mach_id.Join("','") }')) " +
            $"AND (@stockIsNull IS NULL OR stock IN ('{ d.stock.Join("','") }')) " +
            $"AND (@quantityIsNull IS NULL OR quantity IN ('{ d.quantity.Join("','") }')) " +
            $"AND (@weightIsNull IS NULL OR weight IN ('{ d.weight.Join("','") }')) " +
            $"AND (@staffIsNull IS NULL OR staff IN ('{ d.staff.Join("','") }')) " +
            $"AND (@rec_dateIsNull IS NULL OR rec_date IN ('{ d.rec_date.Join("','") }')) " +
            $"AND (@rec_qtyIsNull IS NULL OR rec_qty IN ('{ d.rec_qty.Join("','") }')) " +
            $"AND (@rec_weiIsNull IS NULL OR rec_wei IN ('{ d.rec_wei.Join("','") }')) " +
            $"AND (@u_priceIsNull IS NULL OR u_price IN ('{ d.u_price.Join("','") }')) " +
            $"AND (@t_priceIsNull IS NULL OR t_price IN ('{ d.t_price.Join("','") }')) " +
            $"AND (@s_priceIsNull IS NULL OR s_price IN ('{ d.s_price.Join("','") }')) " +
            $"AND (@roy_prcIsNull IS NULL OR roy_prc IN ('{ d.roy_prc.Join("','") }')) " +
            $"AND (@flagIsNull IS NULL OR flag IN ('{ d.flag.Join("','") }')) " +
            $"AND (@chkIsNull IS NULL OR chk IN ('{ d.chk.Join("','") }')) " +
            $"AND (@edit_flagIsNull IS NULL OR edit_flag IN ('{ d.edit_flag.Join("','") }')) " +
            $"AND (@post_flagIsNull IS NULL OR post_flag IN ('{ d.post_flag.Join("','") }')) " +
            $"AND (@o_flagIsNull IS NULL OR o_flag IN ('{ d.o_flag.Join("','") }')) " +
            $"AND (@barcodeIsNull IS NULL OR barcode IN ('{ d.barcode.Join("','") }')) " +
            $"AND (@billIsNull IS NULL OR bill IN ('{ d.bill.Join("','") }')) " +
            $"AND (@ppost_flagIsNull IS NULL OR ppost_flag IN ('{ d.ppost_flag.Join("','") }')) " +
            $"AND (@p_typeIsNull IS NULL OR p_type IN ('{ d.p_type.Join("','") }')) " +
            $"AND (@groupIsNull IS NULL OR group IN ('{ d.group.Join("','") }')) " +
            $"AND (@branchIsNull IS NULL OR branch IN ('{ d.branch.Join("','") }')) " +
            $"AND (@prn_flagIsNull IS NULL OR prn_flag IN ('{ d.prn_flag.Join("','") }')) " +
            $"AND (@backupflagIsNull IS NULL OR backupflag IN ('{ d.backupflag.Join("','") }')) " +
            $"AND (@pqgradecdIsNull IS NULL OR pqgradecd IN ('{ d.pqgradecd.Join("','") }')) " +
            $"AND (@prb_codeIsNull IS NULL OR prb_code IN ('{ d.prb_code.Join("','") }')) " +
            $"AND (brn_pay LIKE @txtSearch OR brn_pay LIKE @txtSearch) " ;  
            //"ORDER BY  ;"; 
            */

            var res = Query<PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam>(cmd, param).ToList();
            return res;
        }

        public int Insert(PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam d, string userID = "", SqlTransaction transac = null)
        {
            var param = new Dapper.DynamicParameters();
            param.Add("@brn_pay", d.brn_pay);
            param.Add("@pay_date", d.pay_date);
            param.Add("@bar_grp", d.bar_grp);
            param.Add("@res_id", d.res_id);
            param.Add("@pay_item", d.pay_item);
            param.Add("@oun_date", d.oun_date);
            param.Add("@item", d.item);
            param.Add("@mach_id", d.mach_id);
            param.Add("@stock", d.stock);
            param.Add("@quantity", d.quantity);
            param.Add("@weight", d.weight);
            param.Add("@staff", d.staff);
            param.Add("@rec_date", d.rec_date);
            param.Add("@rec_qty", d.rec_qty);
            param.Add("@rec_wei", d.rec_wei);
            param.Add("@u_price", d.u_price);
            param.Add("@t_price", d.t_price);
            param.Add("@s_price", d.s_price);
            param.Add("@roy_prc", d.roy_prc);
            param.Add("@flag", d.flag);
            param.Add("@chk", d.chk);
            param.Add("@edit_flag", d.edit_flag);
            param.Add("@post_flag", d.post_flag);
            param.Add("@o_flag", d.o_flag);
            param.Add("@barcode", d.barcode);
            param.Add("@bill", d.bill);
            param.Add("@ppost_flag", d.ppost_flag);
            param.Add("@p_type", d.p_type);
            param.Add("@group", d.group);
            param.Add("@branch", d.branch);
            param.Add("@prn_flag", d.prn_flag);
            param.Add("@backupflag", d.backupflag);
            param.Add("@pqgradecd", d.pqgradecd);
            param.Add("@prb_code", d.prb_code);
            string cmd = "INSERT INTO product.dbo.PDK1_M_PaOunDam " +
            $"      (brn_pay, pay_date, bar_grp, res_id, pay_item, oun_date, item, mach_id, stock, quantity, weight, staff, rec_date, rec_qty, rec_wei, u_price, t_price, s_price, roy_prc, flag, chk, edit_flag, post_flag, o_flag, barcode, bill, ppost_flag, p_type, group, branch, prn_flag, backupflag, pqgradecd, prb_code) " +
            $"VALUES(@brn_pay, @pay_date, @bar_grp, @res_id, @pay_item, @oun_date, @item, @mach_id, @stock, @quantity, @weight, @staff, @rec_date, @rec_qty, @rec_wei, @u_price, @t_price, @s_price, @roy_prc, @flag, @chk, @edit_flag, @post_flag, @o_flag, @barcode, @bill, @ppost_flag, @p_type, @group, @branch, @prn_flag, @backupflag, @pqgradecd, @prb_code); " +
            $"SELECT SCOPE_IDENTITY();";
            return ExecuteScalar<int>(cmd, param);
        }

        public int Update(PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam d, string userID = "", SqlTransaction transac = null)
        {
            var param = new Dapper.DynamicParameters();
            param.Add("@brn_pay", d.brn_pay.GetValue());
            param.Add("@pay_date", d.pay_date);
            param.Add("@bar_grp", d.bar_grp.GetValue());
            param.Add("@res_id", d.res_id.GetValue());
            param.Add("@pay_item", d.pay_item);
            param.Add("@oun_date", d.oun_date);
            param.Add("@item", d.item);
            param.Add("@mach_id", d.mach_id.GetValue());
            param.Add("@stock", d.stock.GetValue());
            param.Add("@quantity", d.quantity);
            param.Add("@weight", d.weight);
            param.Add("@staff", d.staff.GetValue());
            param.Add("@rec_date", d.rec_date);
            param.Add("@rec_qty", d.rec_qty);
            param.Add("@rec_wei", d.rec_wei);
            param.Add("@u_price", d.u_price);
            param.Add("@t_price", d.t_price);
            param.Add("@s_price", d.s_price);
            param.Add("@roy_prc", d.roy_prc);
            param.Add("@flag", d.flag);
            param.Add("@chk", d.chk.GetValue());
            param.Add("@edit_flag", d.edit_flag.GetValue());
            param.Add("@post_flag", d.post_flag.GetValue());
            param.Add("@o_flag", d.o_flag.GetValue());
            param.Add("@barcode", d.barcode.GetValue());
            param.Add("@bill", d.bill.GetValue());
            param.Add("@ppost_flag", d.ppost_flag.GetValue());
            param.Add("@p_type", d.p_type.GetValue());
            param.Add("@group", d.group);
            param.Add("@branch", d.branch.GetValue());
            param.Add("@prn_flag", d.prn_flag.GetValue());
            param.Add("@backupflag", d.backupflag.GetValue());
            param.Add("@pqgradecd", d.pqgradecd.GetValue());
            param.Add("@prb_code", d.prb_code.GetValue());
            string cmd = "";
            /*
                   cmd = UPDATE product.dbo.PDK1_M_PaOunDam "+
            "SET brn_pay = @brn_pay "+ 
            " , pay_date = @pay_date "+ 
            " , bar_grp = @bar_grp "+ 
            " , res_id = @res_id "+ 
            " , pay_item = @pay_item "+ 
            " , oun_date = @oun_date "+ 
            " , item = @item "+ 
            " , mach_id = @mach_id "+ 
            " , stock = @stock "+ 
            " , quantity = @quantity "+ 
            " , weight = @weight "+ 
            " , staff = @staff "+ 
            " , rec_date = @rec_date "+ 
            " , rec_qty = @rec_qty "+ 
            " , rec_wei = @rec_wei "+ 
            " , u_price = @u_price "+ 
            " , t_price = @t_price "+ 
            " , s_price = @s_price "+ 
            " , roy_prc = @roy_prc "+ 
            " , flag = @flag "+ 
            " , chk = @chk "+ 
            " , edit_flag = @edit_flag "+ 
            " , post_flag = @post_flag "+ 
            " , o_flag = @o_flag "+ 
            " , barcode = @barcode "+ 
            " , bill = @bill "+ 
            " , ppost_flag = @ppost_flag "+ 
            " , p_type = @p_type "+ 
            " , group = @group "+ 
            " , branch = @branch "+ 
            " , prn_flag = @prn_flag "+ 
            " , backupflag = @backupflag "+ 
            " , pqgradecd = @pqgradecd "+ 
            " , prb_code = @prb_code "+ 
            "WHERE brn_pay = @brn_pay "+ 
            " AND pay_date = @pay_date "+ 
            " AND bar_grp = @bar_grp "+ 
            " AND res_id = @res_id "+ 
            " AND pay_item = @pay_item "+ 
            " AND oun_date = @oun_date "+ 
            " AND item = @item "+ 
            " AND mach_id = @mach_id "+ 
            " AND stock = @stock "+ 
            " AND quantity = @quantity "+ 
            " AND weight = @weight "+ 
            " AND staff = @staff "+ 
            " AND rec_date = @rec_date "+ 
            " AND rec_qty = @rec_qty "+ 
            " AND rec_wei = @rec_wei "+ 
            " AND u_price = @u_price "+ 
            " AND t_price = @t_price "+ 
            " AND s_price = @s_price "+ 
            " AND roy_prc = @roy_prc "+ 
            " AND flag = @flag "+ 
            " AND chk = @chk "+ 
            " AND edit_flag = @edit_flag "+ 
            " AND post_flag = @post_flag "+ 
            " AND o_flag = @o_flag "+ 
            " AND barcode = @barcode "+ 
            " AND bill = @bill "+ 
            " AND ppost_flag = @ppost_flag "+ 
            " AND p_type = @p_type "+ 
            " AND group = @group "+ 
            " AND branch = @branch "+ 
            " AND prn_flag = @prn_flag "+ 
            " AND backupflag = @backupflag "+ 
            " AND pqgradecd = @pqgradecd "+ 
            " AND prb_code = @prb_code "+ 
            " "; 
            */

            var res = ExecuteNonQuery(transac, cmd, param);
            return res;
        }

        public int Delete(PDK1Model.Model.Dataset.Mssql.Product.PDK1_M_PaOunDam d, string userID = "", SqlTransaction transac = null)
        {
            var param = new Dapper.DynamicParameters();
            param.Add("@brn_pay", d.brn_pay.GetValue());
            param.Add("@pay_date", d.pay_date);
            param.Add("@bar_grp", d.bar_grp.GetValue());
            param.Add("@res_id", d.res_id.GetValue());
            param.Add("@pay_item", d.pay_item);
            param.Add("@oun_date", d.oun_date);
            param.Add("@item", d.item);
            param.Add("@mach_id", d.mach_id.GetValue());
            param.Add("@stock", d.stock.GetValue());
            param.Add("@quantity", d.quantity);
            param.Add("@weight", d.weight);
            param.Add("@staff", d.staff.GetValue());
            param.Add("@rec_date", d.rec_date);
            param.Add("@rec_qty", d.rec_qty);
            param.Add("@rec_wei", d.rec_wei);
            param.Add("@u_price", d.u_price);
            param.Add("@t_price", d.t_price);
            param.Add("@s_price", d.s_price);
            param.Add("@roy_prc", d.roy_prc);
            param.Add("@flag", d.flag);
            param.Add("@chk", d.chk.GetValue());
            param.Add("@edit_flag", d.edit_flag.GetValue());
            param.Add("@post_flag", d.post_flag.GetValue());
            param.Add("@o_flag", d.o_flag.GetValue());
            param.Add("@barcode", d.barcode.GetValue());
            param.Add("@bill", d.bill.GetValue());
            param.Add("@ppost_flag", d.ppost_flag.GetValue());
            param.Add("@p_type", d.p_type.GetValue());
            param.Add("@group", d.group);
            param.Add("@branch", d.branch.GetValue());
            param.Add("@prn_flag", d.prn_flag.GetValue());
            param.Add("@backupflag", d.backupflag.GetValue());
            param.Add("@pqgradecd", d.pqgradecd.GetValue());
            param.Add("@prb_code", d.prb_code.GetValue());
            string cmd = "";
            /*
                   cmd = DELETE FROM product.dbo.PDK1_M_PaOunDam "+
            "WHERE brn_pay = @brn_pay "+ 
            " AND pay_date = @pay_date "+ 
            " AND bar_grp = @bar_grp "+ 
            " AND res_id = @res_id "+ 
            " AND pay_item = @pay_item "+ 
            " AND oun_date = @oun_date "+ 
            " AND item = @item "+ 
            " AND mach_id = @mach_id "+ 
            " AND stock = @stock "+ 
            " AND quantity = @quantity "+ 
            " AND weight = @weight "+ 
            " AND staff = @staff "+ 
            " AND rec_date = @rec_date "+ 
            " AND rec_qty = @rec_qty "+ 
            " AND rec_wei = @rec_wei "+ 
            " AND u_price = @u_price "+ 
            " AND t_price = @t_price "+ 
            " AND s_price = @s_price "+ 
            " AND roy_prc = @roy_prc "+ 
            " AND flag = @flag "+ 
            " AND chk = @chk "+ 
            " AND edit_flag = @edit_flag "+ 
            " AND post_flag = @post_flag "+ 
            " AND o_flag = @o_flag "+ 
            " AND barcode = @barcode "+ 
            " AND bill = @bill "+ 
            " AND ppost_flag = @ppost_flag "+ 
            " AND p_type = @p_type "+ 
            " AND group = @group "+ 
            " AND branch = @branch "+ 
            " AND prn_flag = @prn_flag "+ 
            " AND backupflag = @backupflag "+ 
            " AND pqgradecd = @pqgradecd "+ 
            " AND prb_code = @prb_code "+ 
            " "; 
            */

            var res = ExecuteNonQuery(transac, cmd, param);
            return res;
        }
    }
}
